# Docker Compose para EC2 - Apenas Promtail para envio de logs
# Este arquivo deve ser usado no servidor EC2 onde a API está rodando

version: '3.8'

services:
  promtail:
    image: grafana/promtail:latest
    container_name: promtail
    volumes:
      - ./observability/promtail-config.yml:/etc/promtail/config.yml
      - ./logs:/app/logs
    command: -config.file=/etc/promtail/config.yml
    restart: unless-stopped
    network_mode: "host"
    # network_mode host permite acesso direto à VPS pela rede

# Instruções:
# 1. No arquivo observability/promtail-config.yml, configure o IP da VPS:
#    clients:
#      - url: http://<VPS_IP>:3100/loki/api/v1/push
#
# 2. Certifique-se que a porta 3100 da VPS está acessível do EC2
#
# 3. Para iniciar: docker-compose -f docker-compose.logging.yml up -d
